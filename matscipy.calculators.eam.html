<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>matscipy.calculators.eam package &mdash; matscipy devel documentation</title>
      <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="_static/jquery.js"></script>
        <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/sphinx_highlight.js"></script>
        <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            matscipy
          </a>
              <div class="version">
                devel
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Table of Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="calculators.html">Calculators</a></li>
<li class="toctree-l1"><a class="reference internal" href="fracture_mechanics.html">Fracture Mechanics</a></li>
<li class="toctree-l1"><a class="reference internal" href="plasticity.html">Plasticity</a></li>
<li class="toctree-l1"><a class="reference internal" href="elastic_constants.html">Elastic Constants</a></li>
<li class="toctree-l1"><a class="reference internal" href="api_reference.html">API Reference</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">matscipy</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">matscipy.calculators.eam package</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/matscipy.calculators.eam.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="module-matscipy.calculators.eam">
<span id="matscipy-calculators-eam-package"></span><h1>matscipy.calculators.eam package<a class="headerlink" href="#module-matscipy.calculators.eam" title="Permalink to this heading"></a></h1>
<p>Implements the Embedded Atom Method</p>
<section id="modules">
<h2>Modules<a class="headerlink" href="#modules" title="Permalink to this heading"></a></h2>
<table class="autosummary longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#module-matscipy.calculators.eam.calculator" title="matscipy.calculators.eam.calculator"><code class="xref py py-obj docutils literal notranslate"><span class="pre">matscipy.calculators.eam.calculator</span></code></a></p></td>
<td><p>EAM calculator</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#module-matscipy.calculators.eam.io" title="matscipy.calculators.eam.io"><code class="xref py py-obj docutils literal notranslate"><span class="pre">matscipy.calculators.eam.io</span></code></a></p></td>
<td><p>Read and write tabulated EAM potentials</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#module-matscipy.calculators.eam.average_atom" title="matscipy.calculators.eam.average_atom"><code class="xref py py-obj docutils literal notranslate"><span class="pre">matscipy.calculators.eam.average_atom</span></code></a></p></td>
<td><p></p></td>
</tr>
</tbody>
</table>
</section>
<section id="module-matscipy.calculators.eam.calculator">
<span id="matscipy-calculators-eam-calculator-module"></span><h2>matscipy.calculators.eam.calculator module<a class="headerlink" href="#module-matscipy.calculators.eam.calculator" title="Permalink to this heading"></a></h2>
<p>EAM calculator</p>
<dl class="py class">
<dt class="sig sig-object py" id="matscipy.calculators.eam.calculator.EAM">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">matscipy.calculators.eam.calculator.</span></span><span class="sig-name descname"><span class="pre">EAM</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fn</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atomic_numbers</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">F</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rep</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutoff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kind</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'eam/alloy'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#matscipy.calculators.eam.calculator.EAM" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">MatscipyCalculator</span></code></p>
<dl class="py attribute">
<dt class="sig sig-object py" id="matscipy.calculators.eam.calculator.EAM.implemented_properties">
<span class="sig-name descname"><span class="pre">implemented_properties</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">['energy',</span> <span class="pre">'free_energy',</span> <span class="pre">'stress',</span> <span class="pre">'forces',</span> <span class="pre">'hessian']</span></em><a class="headerlink" href="#matscipy.calculators.eam.calculator.EAM.implemented_properties" title="Permalink to this definition"></a></dt>
<dd><p>Properties calculator can handle (energy, forces, …)</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="matscipy.calculators.eam.calculator.EAM.default_parameters">
<span class="sig-name descname"><span class="pre">default_parameters</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{}</span></em><a class="headerlink" href="#matscipy.calculators.eam.calculator.EAM.default_parameters" title="Permalink to this definition"></a></dt>
<dd><p>Default parameters</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="matscipy.calculators.eam.calculator.EAM.name">
<span class="sig-name descname"><span class="pre">name</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'EAM'</span></em><a class="headerlink" href="#matscipy.calculators.eam.calculator.EAM.name" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="matscipy.calculators.eam.calculator.EAM.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fn</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atomic_numbers</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">F</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rep</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutoff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kind</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'eam/alloy'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#matscipy.calculators.eam.calculator.EAM.__init__" title="Permalink to this definition"></a></dt>
<dd><p>Basic calculator implementation.</p>
<dl class="simple">
<dt>restart: str</dt><dd><p>Prefix for restart file.  May contain a directory. Default
is None: don’t restart.</p>
</dd>
<dt>ignore_bad_restart_file: bool</dt><dd><p>Deprecated, please do not use.
Passing more than one positional argument to Calculator()
is deprecated and will stop working in the future.
Ignore broken or missing restart file.  By default, it is an
error if the restart file is missing or broken.</p>
</dd>
<dt>directory: str or PurePath</dt><dd><p>Working directory in which to read and write files and
perform calculations.</p>
</dd>
<dt>label: str</dt><dd><p>Name used for all files.  Not supported by all calculators.
May contain a directory, but please use the directory parameter
for that instead.</p>
</dd>
<dt>atoms: Atoms object</dt><dd><p>Optional Atoms object to which the calculator will be
attached.  When restarting, atoms will get its positions and
unit-cell updated from file.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="matscipy.calculators.eam.calculator.EAM.energy_virial_and_forces">
<span class="sig-name descname"><span class="pre">energy_virial_and_forces</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">atomic_numbers_i</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">i_n</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">j_n</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dr_nc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">abs_dr_n</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#matscipy.calculators.eam.calculator.EAM.energy_virial_and_forces" title="Permalink to this definition"></a></dt>
<dd><p>Compute the potential energy, the virial and the forces.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>atomic_numbers_i</strong> (<em>array_like</em>) – Atomic number for each atom in the system</p></li>
<li><p><strong>i_n</strong> (<em>array_like</em>) – Neighbor pairs</p></li>
<li><p><strong>j_n</strong> (<em>array_like</em>) – Neighbor pairs</p></li>
<li><p><strong>dr_nc</strong> (<em>array_like</em>) – Distance vectors between neighbors</p></li>
<li><p><strong>abd_dr_n</strong> (<em>array_like</em>) – Length of distance vectors between neighbors</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>epot</strong> (<em>float</em>) – Potential energy</p></li>
<li><p><strong>virial_v</strong> (<em>array</em>) – Virial</p></li>
<li><p><strong>forces_ic</strong> (<em>array</em>) – Forces acting on each atom</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="matscipy.calculators.eam.calculator.EAM.calculate">
<span class="sig-name descname"><span class="pre">calculate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">atoms</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">properties</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">system_changes</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#matscipy.calculators.eam.calculator.EAM.calculate" title="Permalink to this definition"></a></dt>
<dd><p>Do the calculation.</p>
<dl class="simple">
<dt>properties: list of str</dt><dd><p>List of what needs to be calculated.  Can be any combination
of ‘energy’, ‘forces’, ‘stress’, ‘dipole’, ‘charges’, ‘magmom’
and ‘magmoms’.</p>
</dd>
<dt>system_changes: list of str</dt><dd><p>List of what has changed since last calculation.  Can be
any combination of these six: ‘positions’, ‘numbers’, ‘cell’,
‘pbc’, ‘initial_charges’ and ‘initial_magmoms’.</p>
</dd>
</dl>
<p>Subclasses need to implement this, but can ignore properties
and system_changes if they want.  Calculated properties should
be inserted into results dictionary like shown in this dummy
example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="bp">self</span><span class="o">.</span><span class="n">results</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;energy&#39;</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span>
                <span class="s1">&#39;forces&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">atoms</span><span class="p">),</span> <span class="mi">3</span><span class="p">)),</span>
                <span class="s1">&#39;stress&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">6</span><span class="p">),</span>
                <span class="s1">&#39;dipole&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span>
                <span class="s1">&#39;charges&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">atoms</span><span class="p">)),</span>
                <span class="s1">&#39;magmom&#39;</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span>
                <span class="s1">&#39;magmoms&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">atoms</span><span class="p">))}</span>
</pre></div>
</div>
<p>The subclass implementation should first call this
implementation to set the atoms attribute and create any missing
directories.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="matscipy.calculators.eam.calculator.EAM.calculate_hessian_matrix">
<span class="sig-name descname"><span class="pre">calculate_hessian_matrix</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">atoms</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">divide_by_masses</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#matscipy.calculators.eam.calculator.EAM.calculate_hessian_matrix" title="Permalink to this definition"></a></dt>
<dd><p>Compute the Hessian matrix</p>
<p>The Hessian matrix is the matrix of second derivatives
of the potential energy <span class="math notranslate nohighlight">\(\mathcal{V}_\mathrm{int}\)</span>
with respect to coordinates, i.e.</p>
<div class="math notranslate nohighlight">
\[\frac{\partial^2 \mathcal{V}_\mathrm{int}}
     {\partial r_{\nu{}i}\partial r_{\mu{}j}},\]</div>
<p>where the indices <span class="math notranslate nohighlight">\(\mu\)</span> and <span class="math notranslate nohighlight">\(\nu\)</span> refer to atoms and
the indices <span class="math notranslate nohighlight">\(i\)</span> and <span class="math notranslate nohighlight">\(j\)</span> refer to the components of the
position vector <span class="math notranslate nohighlight">\(r_\nu\)</span> along the three spatial directions.</p>
<p>The Hessian matrix has contributions from the pair potential
and the embedding energy,</p>
<div class="math notranslate nohighlight">
\[\frac{\partial^2 \mathcal{V}_\mathrm{int}}{\partial r_{\nu{}i}\partial r_{\mu{}j}} =
\frac{\partial^2 \mathcal{V}_\mathrm{pair}}{ \partial r_{\nu i} \partial r_{\mu j}} +
\frac{\partial^2 \mathcal{V}_\mathrm{embed}}{\partial r_{\nu i} \partial r_{\mu j}}.\]</div>
<p>The contribution from the pair potential is</p>
<div class="math notranslate nohighlight">
\[\begin{split}\frac{\partial^2 \mathcal{V}_\mathrm{pair}}{ \partial r_{\nu i} \partial r_{\mu j}} &amp;=
-\phi_{\nu\mu}'' \left(
\frac{r_{\nu\mu i}}{r_{\nu\mu}}
\frac{r_{\nu\mu j}}{r_{\nu\mu}}
\right)
-\frac{\phi_{\nu\mu}'}{r_{\nu\mu}}\left(
\delta_{ij}-
\frac{r_{\nu\mu i}}{r_{\nu\mu}}
\frac{r_{\nu\mu j}}{r_{\nu\mu}}
\right) \\
&amp;+\delta_{\nu\mu}\sum_{\gamma\neq\nu}^{N}
\phi_{\nu\gamma}'' \left(
\frac{r_{\nu\gamma i}}{r_{\nu\gamma}}
\frac{r_{\nu\gamma j}}{r_{\nu\gamma}}
\right)
+\delta_{\nu\mu}\sum_{\gamma\neq\nu}^{N}\frac{\phi_{\nu\gamma}'}{r_{\nu\gamma}}\left(
\delta_{ij}-
\frac{r_{\nu\gamma i}}{r_{\nu\gamma}}
\frac{r_{\nu\gamma j}}{r_{\nu\gamma}}
\right).\end{split}\]</div>
<p>The contribution of the embedding energy to the Hessian matrix is a sum of eight terms,</p>
<div class="math notranslate nohighlight">
\[\begin{split}\frac{\mathcal{V}_\mathrm{embed}}{\partial r_{\mu j} \partial r_{\nu i}}
    &amp;= T_1 + T_2 + T_3 + T_4 + T_5 + T_6 + T_7 + T_8 \\
T_1 &amp;=
\delta_{\nu\mu}U_\nu''
\sum_{\gamma\neq\nu}^{N}g_{\nu\gamma}'\frac{r_{\nu\gamma i}}{r_{\nu\gamma}}
\sum_{\gamma\neq\nu}^{N}g_{\nu\gamma}'\frac{r_{\nu\gamma j}}{r_{\nu\gamma}} \\
T_2 &amp;=
-u_\nu''g_{\nu\mu}' \frac{r_{\nu\mu j}}{r_{\nu\mu}} \sum_{\gamma\neq\nu}^{N}
G_{\nu\gamma}' \frac{r_{\nu\gamma i}}{r_{\nu\gamma}} \\
T_3 &amp;=
+u_\mu''g_{\mu\nu}' \frac{r_{\nu\mu i}}{r_{\nu\mu}} \sum_{\gamma\neq\mu}^{N}
G_{\mu\gamma}' \frac{r_{\mu\gamma j}}{r_{\mu\gamma}} \\
T_4 &amp;= -\left(u_\mu'g_{\mu\nu}'' + u_\nu'g_{\nu\mu}''\right)
\left(
\frac{r_{\nu\mu i}}{r_{\nu\mu}}
\frac{r_{\nu\mu j}}{r_{\nu\mu}}
\right)\\
T_5 &amp;= \delta_{\nu\mu} \sum_{\gamma\neq\nu}^{N}
\left(U_\gamma'g_{\gamma\nu}'' + U_\nu'g_{\nu\gamma}''\right)
\left(
\frac{r_{\nu\gamma i}}{r_{\nu\gamma}}
\frac{r_{\nu\gamma j}}{r_{\nu\gamma}}
\right) \\
T_6 &amp;= -\left(U_\mu'g_{\mu\nu}' + U_\nu'g_{\nu\mu}'\right) \frac{1}{r_{\nu\mu}}
\left(
\delta_{ij}-
\frac{r_{\nu\mu i}}{r_{\nu\mu}}
\frac{r_{\nu\mu j}}{r_{\nu\mu}}
\right) \\
T_7 &amp;= \delta_{\nu\mu} \sum_{\gamma\neq\nu}^{N}
\left(U_\gamma'g_{\gamma\nu}' + U_\nu'g_{\nu\gamma}'\right) \frac{1}{r_{\nu\gamma}}
\left(\delta_{ij}-
\frac{r_{\nu\gamma i}}{r_{\nu\gamma}}
\frac{r_{\nu\gamma j}}{r_{\nu\gamma}}
\right) \\
T_8 &amp;= \sum_{\substack{\gamma\neq\nu \\ \gamma \neq \mu}}^{N}
U_\gamma'' g_{\gamma\nu}'g_{\gamma\mu}'
\frac{r_{\gamma\nu i}}{r_{\gamma\nu}}
\frac{r_{\gamma\mu j}}{r_{\gamma\mu}}\end{split}\]</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>atoms</strong> (<em>ase.Atoms</em>) – </p></li>
<li><p><strong>divide_by_masses</strong> (<em>bool</em>) – Divide block <span class="math notranslate nohighlight">\(\nu\mu\)</span> by <span class="math notranslate nohighlight">\(m_\nu{}m_\mu{}\)</span> to obtain the dynamical matrix</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>D</strong> – Block Sparse Row matrix with the nonzero blocks</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>numpy.matrix</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<dl class="simple">
<dt>Notation:</dt><dd><ul class="simple">
<li><p><span class="math notranslate nohighlight">\(N\)</span> Number of atoms</p></li>
<li><p><span class="math notranslate nohighlight">\(\mathcal{V}_\mathrm{int}\)</span>  Total potential energy</p></li>
<li><p><span class="math notranslate nohighlight">\(\mathcal{V}_\mathrm{pair}\)</span> Pair potential</p></li>
<li><p><span class="math notranslate nohighlight">\(\mathcal{V}_\mathrm{embed}\)</span> Embedding energy</p></li>
<li><p><span class="math notranslate nohighlight">\(r_{\nu{}i}\)</span>  Component <span class="math notranslate nohighlight">\(i\)</span> of the position vector of atom <span class="math notranslate nohighlight">\(\nu\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(r_{\nu\mu{}i} = r_{\mu{}i}-r_{\nu{}i}\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(r_{\nu\mu{}}\)</span> Norm of <span class="math notranslate nohighlight">\(r_{\nu\mu{}i}\)</span>, i.e.<span class="math notranslate nohighlight">\(\left(r_{\nu\mu{}1}^2+r_{\nu\mu{}2}^2+r_{\nu\mu{}3}^2\right)^{1/2}\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(\phi_{\nu\mu}(r_{\nu\mu{}})\)</span> Pair potential energy of atoms <span class="math notranslate nohighlight">\(\nu\)</span> and <span class="math notranslate nohighlight">\(\mu\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(\rho_{\nu}\)</span> Total electron density of atom <span class="math notranslate nohighlight">\(\nu\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(U_\nu(\rho_nu)\)</span> Embedding energy of atom <span class="math notranslate nohighlight">\(\nu\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(g_{\delta}\left(r_{\gamma\delta}\right) \equiv g_{\gamma\delta}\)</span> Contribution from atom <span class="math notranslate nohighlight">\(\delta\)</span> to <span class="math notranslate nohighlight">\(\rho_\gamma\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(m_\nu\)</span> mass of atom <span class="math notranslate nohighlight">\(\nu\)</span></p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="matscipy.calculators.eam.calculator.EAM.get_hessian">
<span class="sig-name descname"><span class="pre">get_hessian</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">atoms</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">format</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'sparse'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">divide_by_masses</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#matscipy.calculators.eam.calculator.EAM.get_hessian" title="Permalink to this definition"></a></dt>
<dd><p>Calculate the Hessian matrix for a pair potential. For an atomic
configuration with N atoms in d dimensions the hessian matrix is a
symmetric, hermitian matrix with a shape of (d*N,d*N). The matrix is
in general a sparse matrix, which consists of dense blocks of shape
(d,d), which are the mixed second derivatives.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>atoms</strong> (<em>ase.Atoms</em>) – Atomic configuration in a local or global minima.</p></li>
<li><p><strong>format</strong> (<em>str</em><em>, </em><em>optional</em>) – Output format of the Hessian matrix, either ‘dense’, ‘sparse’ or
‘neighbour-list’. The format ‘sparse’ returns a sparse matrix
representations of scipy. The format ‘neighbor-list’ returns
a representation within matscipy’s and ASE’s neighbor list
format, i.e. the Hessian is returned per neighbor.
(Default: ‘dense’)</p></li>
<li><p><strong>divide_by_masses</strong> (<em>bool</em><em>, </em><em>optional</em>) – Divided each block entry n the Hessian matrix by sqrt(m_i m_j)
where m_i and m_j are the masses of the two atoms for the Hessian
matrix.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><em>If format==’sparse’</em></p></li>
<li><p><strong>hessian</strong> (<em>scipy.sparse.bsr_matrix</em>) – Hessian matrix in sparse matrix representation</p></li>
<li><p><em>If format==’neighbor-list’</em></p></li>
<li><p><strong>hessian_ncc</strong> (<em>np.ndarray</em>) – Array containing the Hessian blocks per atom pair</p></li>
<li><p><strong>distances_nc</strong> (<em>np.ndarray</em>) – Distance vectors between atom pairs</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="matscipy.calculators.eam.calculator.EAM.band_structure">
<span class="sig-name descname"><span class="pre">band_structure</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#matscipy.calculators.eam.calculator.EAM.band_structure" title="Permalink to this definition"></a></dt>
<dd><p>Create band-structure object for plotting.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="matscipy.calculators.eam.calculator.EAM.calculate_numerical_forces">
<span class="sig-name descname"><span class="pre">calculate_numerical_forces</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">atoms</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">d</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.001</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#matscipy.calculators.eam.calculator.EAM.calculate_numerical_forces" title="Permalink to this definition"></a></dt>
<dd><p>Calculate numerical forces using finite difference.</p>
<p>All atoms will be displaced by +d and -d in all directions.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="matscipy.calculators.eam.calculator.EAM.calculate_numerical_stress">
<span class="sig-name descname"><span class="pre">calculate_numerical_stress</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">atoms</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">d</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-06</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">voigt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#matscipy.calculators.eam.calculator.EAM.calculate_numerical_stress" title="Permalink to this definition"></a></dt>
<dd><p>Calculate numerical stress using finite difference.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="matscipy.calculators.eam.calculator.EAM.calculate_properties">
<span class="sig-name descname"><span class="pre">calculate_properties</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">atoms</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">properties</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#matscipy.calculators.eam.calculator.EAM.calculate_properties" title="Permalink to this definition"></a></dt>
<dd><p>This method is experimental; currently for internal use.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="matscipy.calculators.eam.calculator.EAM.calculation_required">
<span class="sig-name descname"><span class="pre">calculation_required</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">atoms</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">properties</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#matscipy.calculators.eam.calculator.EAM.calculation_required" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="matscipy.calculators.eam.calculator.EAM.check_state">
<span class="sig-name descname"><span class="pre">check_state</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">atoms</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-15</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#matscipy.calculators.eam.calculator.EAM.check_state" title="Permalink to this definition"></a></dt>
<dd><p>Check for any system changes since last calculation.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="matscipy.calculators.eam.calculator.EAM.directory">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">directory</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em><a class="headerlink" href="#matscipy.calculators.eam.calculator.EAM.directory" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="matscipy.calculators.eam.calculator.EAM.discard_results_on_any_change">
<span class="sig-name descname"><span class="pre">discard_results_on_any_change</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">False</span></em><a class="headerlink" href="#matscipy.calculators.eam.calculator.EAM.discard_results_on_any_change" title="Permalink to this definition"></a></dt>
<dd><p>Whether we purge the results following any change in the set() method.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="matscipy.calculators.eam.calculator.EAM.export_properties">
<span class="sig-name descname"><span class="pre">export_properties</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#matscipy.calculators.eam.calculator.EAM.export_properties" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="matscipy.calculators.eam.calculator.EAM.get_atoms">
<span class="sig-name descname"><span class="pre">get_atoms</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#matscipy.calculators.eam.calculator.EAM.get_atoms" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="matscipy.calculators.eam.calculator.EAM.get_birch_coefficients">
<span class="sig-name descname"><span class="pre">get_birch_coefficients</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">atoms</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#matscipy.calculators.eam.calculator.EAM.get_birch_coefficients" title="Permalink to this definition"></a></dt>
<dd><p>Compute the Birch coefficients (Effective elastic constants at non-zero stress).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>atoms</strong> (<em>ase.Atoms</em>) – Atomic configuration in a local or global minima.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="matscipy.calculators.eam.calculator.EAM.get_born_elastic_constants">
<span class="sig-name descname"><span class="pre">get_born_elastic_constants</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">atoms</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#matscipy.calculators.eam.calculator.EAM.get_born_elastic_constants" title="Permalink to this definition"></a></dt>
<dd><p>Compute the Born elastic constants.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>atoms</strong> (<em>ase.Atoms</em>) – Atomic configuration in a local or global minima.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="matscipy.calculators.eam.calculator.EAM.get_charges">
<span class="sig-name descname"><span class="pre">get_charges</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">atoms</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#matscipy.calculators.eam.calculator.EAM.get_charges" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="matscipy.calculators.eam.calculator.EAM.get_default_parameters">
<span class="sig-name descname"><span class="pre">get_default_parameters</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#matscipy.calculators.eam.calculator.EAM.get_default_parameters" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="matscipy.calculators.eam.calculator.EAM.get_dipole_moment">
<span class="sig-name descname"><span class="pre">get_dipole_moment</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">atoms</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#matscipy.calculators.eam.calculator.EAM.get_dipole_moment" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="matscipy.calculators.eam.calculator.EAM.get_dynamical_matrix">
<span class="sig-name descname"><span class="pre">get_dynamical_matrix</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">atoms</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#matscipy.calculators.eam.calculator.EAM.get_dynamical_matrix" title="Permalink to this definition"></a></dt>
<dd><p>Compute dynamical matrix (=mass weighted Hessian).</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="matscipy.calculators.eam.calculator.EAM.get_elastic_constants">
<span class="sig-name descname"><span class="pre">get_elastic_constants</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">atoms</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cg_parameters</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{'M':</span> <span class="pre">None,</span> <span class="pre">'atol':</span> <span class="pre">1e-05,</span> <span class="pre">'callback':</span> <span class="pre">None,</span> <span class="pre">'maxiter':</span> <span class="pre">None,</span> <span class="pre">'tol':</span> <span class="pre">1e-05,</span> <span class="pre">'x0':</span> <span class="pre">None}</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#matscipy.calculators.eam.calculator.EAM.get_elastic_constants" title="Permalink to this definition"></a></dt>
<dd><p>Compute the elastic constants at zero temperature.
These are sum of the born, the non-affine and the stress contribution.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>atoms</strong> (<em>ase.Atoms</em>) – Atomic configuration in a local or global minima.</p></li>
<li><p><strong>cg_parameters</strong> (<em>dict</em>) – <p>Dictonary for the conjugate-gradient solver.</p>
<dl class="simple">
<dt>x0: {array, matrix}</dt><dd><p>Starting guess for the solution.</p>
</dd>
<dt>tol/atol: float, optional</dt><dd><p>Tolerances for convergence, norm(residual) &lt;= max(tol*norm(b), atol).</p>
</dd>
<dt>maxiter: int</dt><dd><p>Maximum number of iterations. Iteration will stop after maxiter steps even if the specified tolerance has not been achieved.</p>
</dd>
<dt>M: {sparse matrix, dense matrix, LinearOperator}</dt><dd><p>Preconditioner for A.</p>
</dd>
<dt>callback: function</dt><dd><p>User-supplied function to call after each iteration.</p>
</dd>
</dl>
</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="matscipy.calculators.eam.calculator.EAM.get_forces">
<span class="sig-name descname"><span class="pre">get_forces</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">atoms</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#matscipy.calculators.eam.calculator.EAM.get_forces" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="matscipy.calculators.eam.calculator.EAM.get_magnetic_moment">
<span class="sig-name descname"><span class="pre">get_magnetic_moment</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">atoms</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#matscipy.calculators.eam.calculator.EAM.get_magnetic_moment" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="matscipy.calculators.eam.calculator.EAM.get_magnetic_moments">
<span class="sig-name descname"><span class="pre">get_magnetic_moments</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">atoms</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#matscipy.calculators.eam.calculator.EAM.get_magnetic_moments" title="Permalink to this definition"></a></dt>
<dd><p>Calculate magnetic moments projected onto atoms.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="matscipy.calculators.eam.calculator.EAM.get_non_affine_contribution_to_elastic_constants">
<span class="sig-name descname"><span class="pre">get_non_affine_contribution_to_elastic_constants</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">atoms</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eigenvalues</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eigenvectors</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pc_parameters</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cg_parameters</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{'M':</span> <span class="pre">None,</span> <span class="pre">'atol':</span> <span class="pre">1e-05,</span> <span class="pre">'callback':</span> <span class="pre">None,</span> <span class="pre">'maxiter':</span> <span class="pre">None,</span> <span class="pre">'tol':</span> <span class="pre">1e-05,</span> <span class="pre">'x0':</span> <span class="pre">None}</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#matscipy.calculators.eam.calculator.EAM.get_non_affine_contribution_to_elastic_constants" title="Permalink to this definition"></a></dt>
<dd><p><cite>get_non_affine_contribution_to_elastic_constants</cite> is deprecated, use <cite>elasticity.nonaffine_elastic_contribution</cite> instead!</p>
<p>Compute the correction of non-affine displacements to the elasticity tensor.
The computation of the occuring inverse of the Hessian matrix is bypassed by using a cg solver.</p>
<p>If eigenvalues and and eigenvectors are given the inverse of the Hessian can be easily computed.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>atoms</strong> (<em>ase.Atoms</em>) – Atomic configuration in a local or global minima.</p></li>
<li><p><strong>eigenvalues</strong> (<em>array</em>) – Eigenvalues in ascending order obtained by diagonalization of Hessian matrix.
If given, use eigenvalues and eigenvectors to compute non-affine contribution.</p></li>
<li><p><strong>eigenvectors</strong> (<em>array</em>) – Eigenvectors corresponding to eigenvalues.</p></li>
<li><p><strong>cg_parameters</strong> (<em>dict</em>) – <p>Dictonary for the conjugate-gradient solver.</p>
<dl class="simple">
<dt>x0: {array, matrix}</dt><dd><p>Starting guess for the solution.</p>
</dd>
<dt>tol/atol: float, optional</dt><dd><p>Tolerances for convergence, norm(residual) &lt;= max(tol*norm(b), atol).</p>
</dd>
<dt>maxiter: int</dt><dd><p>Maximum number of iterations. Iteration will stop after maxiter steps even if the specified tolerance has not been achieved.</p>
</dd>
<dt>M: {sparse matrix, dense matrix, LinearOperator}</dt><dd><p>Preconditioner for A.</p>
</dd>
<dt>callback: function</dt><dd><p>User-supplied function to call after each iteration.</p>
</dd>
</dl>
</p></li>
<li><p><strong>pc_parameters</strong> (<em>dict</em>) – <p>Dictonary for the incomplete LU decomposition of the Hessian.</p>
<dl class="simple">
<dt>A: array_like</dt><dd><p>Sparse matrix to factorize.</p>
</dd>
<dt>drop_tol: float</dt><dd><p>Drop tolerance for an incomplete LU decomposition.</p>
</dd>
<dt>fill_factor: float</dt><dd><p>Specifies the fill ratio upper bound.</p>
</dd>
<dt>drop_rule: str</dt><dd><p>Comma-separated string of drop rules to use.</p>
</dd>
<dt>permc_spec: str</dt><dd><p>How to permute the columns of the matrix for sparsity.</p>
</dd>
<dt>diag_pivot_thresh: float</dt><dd><p>Threshold used for a diagonal entry to be an acceptable pivot.</p>
</dd>
<dt>relax: int</dt><dd><p>Expert option for customizing the degree of relaxing supernodes.</p>
</dd>
<dt>panel_size: int</dt><dd><p>Expert option for customizing the panel size.</p>
</dd>
<dt>options: dict</dt><dd><p>Dictionary containing additional expert options to SuperLU.</p>
</dd>
</dl>
</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="matscipy.calculators.eam.calculator.EAM.get_nonaffine_forces">
<span class="sig-name descname"><span class="pre">get_nonaffine_forces</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">atoms</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#matscipy.calculators.eam.calculator.EAM.get_nonaffine_forces" title="Permalink to this definition"></a></dt>
<dd><p>Compute the non-affine forces which result from an affine deformation of atoms.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>atoms</strong> (<em>ase.Atoms</em>) – Atomic configuration in a local or global minima.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="matscipy.calculators.eam.calculator.EAM.get_numerical_non_affine_forces">
<span class="sig-name descname"><span class="pre">get_numerical_non_affine_forces</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">atoms</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">d</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-06</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#matscipy.calculators.eam.calculator.EAM.get_numerical_non_affine_forces" title="Permalink to this definition"></a></dt>
<dd><p><cite>get_numerical_non_affine_forces</cite> is deprecated, use <cite>numerical.numerical_nonaffine_forces</cite> instead!</p>
<p>Calculate numerical non-affine forces using central finite differences.
This is done by deforming the box, rescaling atoms and measure the force.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>atoms</strong> (<em>ase.Atoms</em>) – Atomic configuration in a local or global minima.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="matscipy.calculators.eam.calculator.EAM.get_potential_energies">
<span class="sig-name descname"><span class="pre">get_potential_energies</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">atoms</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#matscipy.calculators.eam.calculator.EAM.get_potential_energies" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="matscipy.calculators.eam.calculator.EAM.get_potential_energy">
<span class="sig-name descname"><span class="pre">get_potential_energy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">atoms</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">force_consistent</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#matscipy.calculators.eam.calculator.EAM.get_potential_energy" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="matscipy.calculators.eam.calculator.EAM.get_property">
<span class="sig-name descname"><span class="pre">get_property</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atoms</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">allow_calculation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#matscipy.calculators.eam.calculator.EAM.get_property" title="Permalink to this definition"></a></dt>
<dd><p>Get the named property.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="matscipy.calculators.eam.calculator.EAM.get_stress">
<span class="sig-name descname"><span class="pre">get_stress</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">atoms</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#matscipy.calculators.eam.calculator.EAM.get_stress" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="matscipy.calculators.eam.calculator.EAM.get_stress_contribution_to_elastic_constants">
<span class="sig-name descname"><span class="pre">get_stress_contribution_to_elastic_constants</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">atoms</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#matscipy.calculators.eam.calculator.EAM.get_stress_contribution_to_elastic_constants" title="Permalink to this definition"></a></dt>
<dd><p>Compute the correction to the elastic constants due to non-zero stress in the configuration.
Stress term  results from working with the Cauchy stress.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>atoms</strong> (<em>ase.Atoms</em>) – Atomic configuration in a local or global minima.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="matscipy.calculators.eam.calculator.EAM.get_stresses">
<span class="sig-name descname"><span class="pre">get_stresses</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">atoms</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#matscipy.calculators.eam.calculator.EAM.get_stresses" title="Permalink to this definition"></a></dt>
<dd><p>the calculator should return intensive stresses, i.e., such that
stresses.sum(axis=0) == stress</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="matscipy.calculators.eam.calculator.EAM.ignored_changes">
<span class="sig-name descname"><span class="pre">ignored_changes</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Set</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{}</span></em><a class="headerlink" href="#matscipy.calculators.eam.calculator.EAM.ignored_changes" title="Permalink to this definition"></a></dt>
<dd><p>Properties of Atoms which we ignore for the purposes of cache</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="matscipy.calculators.eam.calculator.EAM.label">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">label</span></span><a class="headerlink" href="#matscipy.calculators.eam.calculator.EAM.label" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="matscipy.calculators.eam.calculator.EAM.read">
<span class="sig-name descname"><span class="pre">read</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">label</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#matscipy.calculators.eam.calculator.EAM.read" title="Permalink to this definition"></a></dt>
<dd><p>Read atoms, parameters and calculated properties from output file.</p>
<p>Read result from self.label file.  Raise ReadError if the file
is not there.  If the file is corrupted or contains an error
message from the calculation, a ReadError should also be
raised.  In case of succes, these attributes must set:</p>
<dl class="simple">
<dt>atoms: Atoms object</dt><dd><p>The state of the atoms from last calculation.</p>
</dd>
<dt>parameters: Parameters object</dt><dd><p>The parameter dictionary.</p>
</dd>
<dt>results: dict</dt><dd><p>Calculated properties like energy and forces.</p>
</dd>
</dl>
<p>The FileIOCalculator.read() method will typically read atoms
and parameters and get the results dict by calling the
read_results() method.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="matscipy.calculators.eam.calculator.EAM.read_atoms">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">read_atoms</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">restart</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#matscipy.calculators.eam.calculator.EAM.read_atoms" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="matscipy.calculators.eam.calculator.EAM.reset">
<span class="sig-name descname"><span class="pre">reset</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#matscipy.calculators.eam.calculator.EAM.reset" title="Permalink to this definition"></a></dt>
<dd><p>Clear all information from old calculation.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="matscipy.calculators.eam.calculator.EAM.set">
<span class="sig-name descname"><span class="pre">set</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#matscipy.calculators.eam.calculator.EAM.set" title="Permalink to this definition"></a></dt>
<dd><p>Set parameters like set(key1=value1, key2=value2, …).</p>
<p>A dictionary containing the parameters that have been changed
is returned.</p>
<p>Subclasses must implement a set() method that will look at the
chaneged parameters and decide if a call to reset() is needed.
If the changed parameters are harmless, like a change in
verbosity, then there is no need to call reset().</p>
<p>The special keyword ‘parameters’ can be used to read
parameters from a file.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="matscipy.calculators.eam.calculator.EAM.set_label">
<span class="sig-name descname"><span class="pre">set_label</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">label</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#matscipy.calculators.eam.calculator.EAM.set_label" title="Permalink to this definition"></a></dt>
<dd><p>Set label and convert label to directory and prefix.</p>
<p>Examples:</p>
<ul class="simple">
<li><p>label=’abc’: (directory=’.’, prefix=’abc’)</p></li>
<li><p>label=’dir1/abc’: (directory=’dir1’, prefix=’abc’)</p></li>
<li><p>label=None: (directory=’.’, prefix=None)</p></li>
</ul>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="matscipy.calculators.eam.calculator.EAM.todict">
<span class="sig-name descname"><span class="pre">todict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">skip_default</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#matscipy.calculators.eam.calculator.EAM.todict" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="matscipy.calculators.eam.calculator.EAM.cutoff">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">cutoff</span></span><a class="headerlink" href="#matscipy.calculators.eam.calculator.EAM.cutoff" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

</section>
<section id="module-matscipy.calculators.eam.io">
<span id="matscipy-ios-eam-io-module"></span><h2>matscipy.ios.eam.io module<a class="headerlink" href="#module-matscipy.calculators.eam.io" title="Permalink to this heading"></a></h2>
<p>Read and write tabulated EAM potentials</p>
<dl class="py class">
<dt class="sig sig-object py" id="matscipy.calculators.eam.io.EAMParameters">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">matscipy.calculators.eam.io.</span></span><span class="sig-name descname"><span class="pre">EAMParameters</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">symbols</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atomic_numbers</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atomic_masses</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lattice_constants</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">crystal_structures</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">number_of_density_grid_points</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">number_of_distance_grid_points</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">density_grid_spacing</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">distance_grid_spacing</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutoff</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#matscipy.calculators.eam.io.EAMParameters" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#matscipy.calculators.eam.io.EAMParameters" title="matscipy.calculators.eam.io.EAMParameters"><code class="xref py py-class docutils literal notranslate"><span class="pre">EAMParameters</span></code></a></p>
<p>Embedded Atom Method potential parameters</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>symbols</strong> (<em>array_like</em>) – Symbols of the elements coverered by
this potential (only for eam/alloy and
eam/fs, EMPTY for eam</p></li>
<li><p><strong>atomic_numbers</strong> (<em>array_like</em>) – Atomic numbers of the elements
covered by this potential</p></li>
<li><p><strong>atomic_masses</strong> (<em>array_like</em>) – Atomic masses of the elements
covered by this potential</p></li>
<li><p><strong>lattice_constants</strong> (<em>array_like</em>) – Lattice constant of a pure crystal
with crystal structure as specified in crystal_structures</p></li>
<li><p><strong>crystal_structures</strong> (<em>array_like</em>) – Crystal structure of the pure metal.</p></li>
<li><p><strong>number_of_density_grid_points</strong> (<em>int</em>) – Number of grid points
of the embedding energy functional</p></li>
<li><p><strong>number_of_distance_grid_points</strong> (<em>int</em>) – Number of grid points of
the electron density function and the pair potential</p></li>
<li><p><strong>density_grid_spacing</strong> (<em>float</em>) – Grid spacing in electron density space</p></li>
<li><p><strong>distance_grid_spacing</strong> (<em>float</em>) – Grid spacing in pair distance space</p></li>
<li><p><strong>cutoff</strong> (<em>float</em>) – Cutoff distance of the potential</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="matscipy.calculators.eam.io.EAMParameters.atomic_masses">
<span class="sig-name descname"><span class="pre">atomic_masses</span></span><a class="headerlink" href="#matscipy.calculators.eam.io.EAMParameters.atomic_masses" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 2</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="matscipy.calculators.eam.io.EAMParameters.atomic_numbers">
<span class="sig-name descname"><span class="pre">atomic_numbers</span></span><a class="headerlink" href="#matscipy.calculators.eam.io.EAMParameters.atomic_numbers" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 1</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="matscipy.calculators.eam.io.EAMParameters.count">
<span class="sig-name descname"><span class="pre">count</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">/</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#matscipy.calculators.eam.io.EAMParameters.count" title="Permalink to this definition"></a></dt>
<dd><p>Return number of occurrences of value.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="matscipy.calculators.eam.io.EAMParameters.crystal_structures">
<span class="sig-name descname"><span class="pre">crystal_structures</span></span><a class="headerlink" href="#matscipy.calculators.eam.io.EAMParameters.crystal_structures" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 4</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="matscipy.calculators.eam.io.EAMParameters.cutoff">
<span class="sig-name descname"><span class="pre">cutoff</span></span><a class="headerlink" href="#matscipy.calculators.eam.io.EAMParameters.cutoff" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 9</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="matscipy.calculators.eam.io.EAMParameters.density_grid_spacing">
<span class="sig-name descname"><span class="pre">density_grid_spacing</span></span><a class="headerlink" href="#matscipy.calculators.eam.io.EAMParameters.density_grid_spacing" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 7</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="matscipy.calculators.eam.io.EAMParameters.distance_grid_spacing">
<span class="sig-name descname"><span class="pre">distance_grid_spacing</span></span><a class="headerlink" href="#matscipy.calculators.eam.io.EAMParameters.distance_grid_spacing" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 8</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="matscipy.calculators.eam.io.EAMParameters.index">
<span class="sig-name descname"><span class="pre">index</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stop</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">9223372036854775807</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">/</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#matscipy.calculators.eam.io.EAMParameters.index" title="Permalink to this definition"></a></dt>
<dd><p>Return first index of value.</p>
<p>Raises ValueError if the value is not present.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="matscipy.calculators.eam.io.EAMParameters.lattice_constants">
<span class="sig-name descname"><span class="pre">lattice_constants</span></span><a class="headerlink" href="#matscipy.calculators.eam.io.EAMParameters.lattice_constants" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 3</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="matscipy.calculators.eam.io.EAMParameters.number_of_density_grid_points">
<span class="sig-name descname"><span class="pre">number_of_density_grid_points</span></span><a class="headerlink" href="#matscipy.calculators.eam.io.EAMParameters.number_of_density_grid_points" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 5</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="matscipy.calculators.eam.io.EAMParameters.number_of_distance_grid_points">
<span class="sig-name descname"><span class="pre">number_of_distance_grid_points</span></span><a class="headerlink" href="#matscipy.calculators.eam.io.EAMParameters.number_of_distance_grid_points" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 6</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="matscipy.calculators.eam.io.EAMParameters.symbols">
<span class="sig-name descname"><span class="pre">symbols</span></span><a class="headerlink" href="#matscipy.calculators.eam.io.EAMParameters.symbols" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 0</p>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="matscipy.calculators.eam.io.read_eam">
<span class="sig-prename descclassname"><span class="pre">matscipy.calculators.eam.io.</span></span><span class="sig-name descname"><span class="pre">read_eam</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">eam_file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kind</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'eam/alloy'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#matscipy.calculators.eam.io.read_eam" title="Permalink to this definition"></a></dt>
<dd><p>Read a tabulated EAM potential</p>
<p>There are differnt flavors of EAM, with different storage
formats. This function supports a subset of the formats supported
by Lammps (<a class="reference external" href="http://lammps.sandia.gov/doc/pair_eam.html">http://lammps.sandia.gov/doc/pair_eam.html</a>),
* eam (DYNAMO funcfl format)
* eam/alloy (DYNAMO setfl format)
* eam/fs (DYNAMO setfl format)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>eam_file</strong> (<em>string</em>) – eam alloy file name</p></li>
<li><p><strong>kind</strong> (<em>{'eam'</em><em>, </em><em>'eam/alloy'</em><em>, </em><em>'eam/fs'}</em>) – kind of EAM file to read</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>source</strong> (<em>string</em>) – Source informations or comment line for the file header</p></li>
<li><p><strong>parameters</strong> (<em>EAMParameters</em>) – EAM potential parameters</p></li>
<li><p><strong>F</strong> (<em>array_like</em>) – contain the tabulated values of the embedded functions
shape = (nb elements, nb of data points)</p></li>
<li><p><strong>f</strong> (<em>array_like</em>) – contain the tabulated values of the density functions
shape = (nb elements, nb of data points)</p></li>
<li><p><strong>rep</strong> (<em>array_like</em>) – contain the tabulated values of pair potential
shape = (nb elements,nb elements, nb of data points)</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="matscipy.calculators.eam.io.mix_eam">
<span class="sig-prename descclassname"><span class="pre">matscipy.calculators.eam.io.</span></span><span class="sig-name descname"><span class="pre">mix_eam</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">files</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kind</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rep_ab</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alphas</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">betas</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#matscipy.calculators.eam.io.mix_eam" title="Permalink to this definition"></a></dt>
<dd><p>mix eam alloy files data set and compute the interspecies pair potential part using the
mean geometric value from each pure species</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>files</strong> (<em>array</em><em> of </em><em>strings</em>) – Contain all the files to merge and mix</p></li>
<li><p><strong>kind</strong> (<em>string</em>) – kinf of eam. Supported eam/alloy, eam/fs</p></li>
<li><p><strong>method</strong> (<em>string</em><em>, </em><em>{geometric</em><em>, </em><em>arithmetic</em><em>, </em><em>weighted</em><em>, </em><em>fitted}</em>) – Method used to mix the pair interaction terms. The geometric,
arithmetic, and weighted arithmetic average are available. The weighted
arithmetic method is using the electron density function values of atom
<code class="code docutils literal notranslate"><span class="pre">a</span></code> and <code class="code docutils literal notranslate"><span class="pre">b</span></code> to ponderate the pair potential between species
<code class="code docutils literal notranslate"><span class="pre">a</span></code> and <span class="math notranslate nohighlight">\(b\)</span>, <code class="code docutils literal notranslate"><span class="pre">rep_ab</span> <span class="pre">=</span> <span class="pre">0.5(fb/fa</span> <span class="pre">*</span> <span class="pre">rep_a</span> <span class="pre">+</span> <span class="pre">fa/fb</span> <span class="pre">*</span>
<span class="pre">rep_b)</span></code>, see [1]. The fitted method is to be used if <code class="code docutils literal notranslate"><span class="pre">rep_ab</span></code>
has been previously fitted and is parse as <span class="math notranslate nohighlight">\(rep_ab\)</span> karg.</p></li>
<li><p><strong>f</strong> (<em>np.array</em>) – fitted density term (for FS eam style)</p></li>
<li><p><strong>rep_ab</strong> (<em>np.array</em>) – fitted rep_ab term</p></li>
<li><p><strong>alphas</strong> (<em>array</em>) – fitted alpha values for the fine tuned mixing.
<code class="code docutils literal notranslate"><span class="pre">rep_ab</span> <span class="pre">=</span> <span class="pre">alpha_a*rep_a+alpha_b*rep_b</span></code></p></li>
<li><p><strong>betas</strong> (<em>array</em>) – fitted values for the fine tuned mixing.
<code class="code docutils literal notranslate"><span class="pre">f_ab</span> <span class="pre">=</span> <span class="pre">beta_00*rep_a+beta_01*rep_b</span></code>
<code class="code docutils literal notranslate"><span class="pre">f_ba</span> <span class="pre">=</span> <span class="pre">beta_10*rep_a+beta_11*rep_b</span></code></p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>sources</strong> (<em>string</em>) – Source informations or comment line for the file header</p></li>
<li><p><strong>parameters_mix</strong> (<em>EAMParameters</em>) – EAM potential parameters</p></li>
<li><p><strong>F_</strong> (<em>array_like</em>) – contain the tabulated values of the embedded functions
shape = (nb elements, nb elements, nb of data points)</p></li>
<li><p><strong>f_</strong> (<em>array_like</em>) – contain the tabulated values of the density functions
shape = (nb elements, nb elements, nb of data points)</p></li>
<li><p><strong>rep_</strong> (<em>array_like</em>) – contain the tabulated values of pair potential
shape = (nb elements, nb elements, nb of data points)</p></li>
</ul>
</p>
</dd>
</dl>
<p class="rubric">References</p>
<ol class="arabic simple">
<li><ol class="upperalpha simple" start="24">
<li><ol class="upperalpha simple" start="23">
<li><p>Zhou, R. A. Johnson, and H. N. G. Wadley, Phys. Rev. B, 69, 144113 (2004)</p></li>
</ol>
</li>
</ol>
</li>
</ol>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="matscipy.calculators.eam.io.write_eam">
<span class="sig-prename descclassname"><span class="pre">matscipy.calculators.eam.io.</span></span><span class="sig-name descname"><span class="pre">write_eam</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">source</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parameters</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">F</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rep</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kind</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'eam'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#matscipy.calculators.eam.io.write_eam" title="Permalink to this definition"></a></dt>
<dd><p>Write an eam lammps format file</p>
<p>There are differnt flavors of EAM, with different storage
formats. This function supports a subset of the formats supported
by Lammps (<a class="reference external" href="http://lammps.sandia.gov/doc/pair_eam.html">http://lammps.sandia.gov/doc/pair_eam.html</a>),
* eam (DYNAMO funcfl format)
* eam/alloy (DYNAMO setfl format)
* eam/fs (DYNAMO setfl format)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>source</strong> (<em>string</em>) – Source information or comment line for the file header</p></li>
<li><p><strong>parameters_mix</strong> (<a class="reference internal" href="#matscipy.calculators.eam.io.EAMParameters" title="matscipy.calculators.eam.io.EAMParameters"><em>EAMParameters</em></a>) – EAM potential parameters</p></li>
<li><p><strong>F</strong> (<em>array_like</em>) – contain the tabulated values of the embedded functions
shape = (nb of data points)</p></li>
<li><p><strong>f</strong> (<em>array_like</em>) – contain the tabulated values of the density functions
shape = (nb of data points)</p></li>
<li><p><strong>rep</strong> (<em>array_like</em>) – contain the tabulated values of pair potential
shape = (nb of data points)</p></li>
<li><p><strong>out_file</strong> (<em>string</em>) – output file name for the eam alloy potential file</p></li>
<li><p><strong>kind</strong> (<em>{'eam'</em><em>, </em><em>'eam/alloy'</em><em>, </em><em>'eam/fs'}</em>) – kind of EAM file to read</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-matscipy.calculators.eam.average_atom">
<span id="matscipy-average-atoms-eam-average-atom-module"></span><h2>matscipy.average_atoms.eam.average_atom module<a class="headerlink" href="#module-matscipy.calculators.eam.average_atom" title="Permalink to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="matscipy.calculators.eam.average_atom.average_potential">
<span class="sig-prename descclassname"><span class="pre">matscipy.calculators.eam.average_atom.</span></span><span class="sig-name descname"><span class="pre">average_potential</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">concentrations</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parameters</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">F</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rep</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kind</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'eam/alloy'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">avg_atom</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'A'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atomic_number</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">999</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">crystal_structure</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'unknown'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lattice_constant</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#matscipy.calculators.eam.average_atom.average_potential" title="Permalink to this definition"></a></dt>
<dd><p>Generate Average-atom potential</p>
<p>The Average-atom (A-atom) potential is a mean-field approximation
for random alloys, see Ref. <a class="reference internal" href="#id1">1</a>. The purpose is to replace the true
elements by a single fictious element, the A-atom. A configuration
of A-atoms yields approximately the same potential energy as the
corresponding random alloy configuration. Other average material
properties, e.g. the elastic constants, are reproduced as well.
For a full derivation, see Ref. <cite>1</cite>.</p>
<p>The A-atom potential has standard EAM form, i.e. it can be tabulated
just like any other EAM potential. The potential functions are simply
the concentration-weighted averages of the pure element functions:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\phi_{AA}\left(r_{\gamma\delta}\right)
    &amp;= \sum_{X}^{N_T}\sum_{Y}^{N_T} c_{X}c_{Y}
    \phi_{XY}\left(r_{\gamma\delta}\right) \quad\text{(pair potential)}, \\
U_{A}\left(\rho_\gamma\right)
    &amp;= \sum_{X}^{N_T}c_{X}U_{X}\left(\rho_\gamma\right) \quad\text{(embedding energy)}, \\
g_A\left(r_{\gamma\delta}\right)
    &amp;= \sum_{X}^{N_T}c_X g_X\left(r_{\gamma\delta}\right)\quad\text{(electron density)},\;\text{and}\\
m_A &amp;= \sum_{X}^{N_T}c_X m_X\quad\text{(mass)}.\end{split}\]</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Currently, only eam/alloy-style potentials can be averaged.
The extension to eam/fs should be straightforward, however.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>concentrations</strong> (<em>array_like</em>) – concentrations of the elements in the A-atom</p></li>
<li><p><strong>parameters</strong> (<a class="reference internal" href="#matscipy.calculators.eam.io.EAMParameters" title="matscipy.calculators.eam.io.EAMParameters"><em>EAMParameters</em></a>) – EAM potential parameters</p></li>
<li><p><strong>F</strong> (<em>array_like</em>) – tabulated embedding energy functionals</p></li>
<li><p><strong>f</strong> (<em>array_like</em>) – tabulated electron density functions</p></li>
<li><p><strong>rep</strong> (<em>array_like</em>) – tabulated pair potential energy functions</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>parameters</strong> (<em>EAMParameters</em>) – EAM potential parameters</p></li>
<li><p><strong>new_F</strong> (<em>array_like</em>) – tabulated embedding energy functionals, including A-atom functional</p></li>
<li><p><strong>new_f</strong> (<em>array_like</em>) – tabulated electron density functions, including A-atom function(s)</p></li>
<li><p><strong>new_rep</strong> (<em>array_like</em>) – tabulated pair potential energy functions, including pairs with A-atom</p></li>
</ul>
</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">matscipy.calculators.eam</span> <span class="kn">import</span> <span class="n">io</span><span class="p">,</span> <span class="n">average_atom</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">source</span><span class="p">,</span> <span class="n">parameters</span><span class="p">,</span> <span class="n">F</span><span class="p">,</span> <span class="n">f</span><span class="p">,</span> <span class="n">rep</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">read_eam</span><span class="p">(</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="s2">&quot;ZrCu.onecolumn.eam.alloy&quot;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">concentrations</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">new_parameters</span><span class="p">,</span> <span class="n">new_F</span><span class="p">,</span> <span class="n">new_f</span><span class="p">,</span> <span class="n">new_rep</span><span class="p">)</span> <span class="o">=</span> <span class="n">average_atom</span><span class="o">.</span><span class="n">average_potential</span><span class="p">(</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">concentrations</span><span class="p">,</span> <span class="n">parameters</span><span class="p">,</span> <span class="n">F</span><span class="p">,</span> <span class="n">f</span><span class="p">,</span> <span class="n">rep</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">composition</span> <span class="o">=</span> <span class="s2">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">c</span> <span class="o">*</span> <span class="mf">100.0</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;% </span><span class="si">{0}</span><span class="s2">,&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">e</span><span class="p">)</span> <span class="k">for</span> <span class="n">c</span><span class="p">,</span> <span class="n">e</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">concentrations</span><span class="p">,</span> <span class="n">parameters</span><span class="o">.</span><span class="n">symbols</span><span class="p">)]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">composition</span> <span class="o">=</span> <span class="n">composition</span><span class="o">.</span><span class="n">rstrip</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">source</span> <span class="o">+=</span> <span class="s2">&quot;, averaged for composition </span><span class="si">{0}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">composition</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">io</span><span class="o">.</span><span class="n">write_eam</span><span class="p">(</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">source</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">new_parameters</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">new_F</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">new_f</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">new_rep</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="s2">&quot;ZrCu.onecolumn.averaged.eam.alloy&quot;</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">kind</span><span class="o">=</span><span class="s2">&quot;eam/alloy&quot;</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">)</span>
</pre></div>
</div>
<p>Read an EAM potential table for two elements in eam/alloy format, and create
a new table with additional A-atom functions for the equicomposition alloy.</p>
<p class="rubric">References</p>
<aside class="footnote-list brackets">
<aside class="footnote brackets" id="id1" role="note">
<span class="label"><span class="fn-bracket">[</span>1<span class="fn-bracket">]</span></span>
<p>Varvenne, C., Luque, A., Nöhring, W. G. &amp; Curtin, W. A.
Average-atom interatomic potential for random alloys.
Physical Review B 93, 104201 (2016).</p>
</aside>
</aside>
<p class="rubric">Notes</p>
<dl class="simple">
<dt>Notation:</dt><dd><ul class="simple">
<li><p><span class="math notranslate nohighlight">\(N\)</span> Number of atoms</p></li>
<li><p><span class="math notranslate nohighlight">\(N_T\)</span> Number of elements</p></li>
<li><p><span class="math notranslate nohighlight">\(r_{\nu\mu{}}\)</span> Pair distance of atoms <span class="math notranslate nohighlight">\(\nu\)</span> and <span class="math notranslate nohighlight">\(\mu\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(\phi_{\nu\mu}(r_{\nu\mu{}})\)</span> Pair potential energy of atoms <span class="math notranslate nohighlight">\(\nu\)</span> and <span class="math notranslate nohighlight">\(\mu\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(\rho_{\nu}\)</span> Total electron density of atom <span class="math notranslate nohighlight">\(\nu\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(U_\nu(\rho_nu)\)</span> Embedding energy of atom <span class="math notranslate nohighlight">\(\nu\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(g_{\delta}\left(r_{\gamma\delta}\right) \equiv g_{\gamma\delta}\)</span> Contribution from atom <span class="math notranslate nohighlight">\(\delta\)</span> to <span class="math notranslate nohighlight">\(\rho_\gamma\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(m_\nu\)</span> mass of atom <span class="math notranslate nohighlight">\(\nu\)</span></p></li>
</ul>
</dd>
</dl>
</dd></dl>

</section>
</section>


           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2015, James Kermode, Lars Pastewka.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>